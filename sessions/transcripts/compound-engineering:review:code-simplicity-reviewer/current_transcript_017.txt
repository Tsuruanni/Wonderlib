          "content": "import 'package:flutter/material.dart';\nimport 'package:flutter_riverpod/flutter_riverpod.dart';\nimport 'package:go_router/go_router.dart';\n\nimport '../../../core/supabase_client.dart';\n\n/// Provider for search query\nfinal vocabularySearchProvider = StateProvider<String>((ref) => '');\n\n/// Provider for level filter\nfinal vocabularyLevelFilterProvider = StateProvider<String?>((ref) => null);\n\n/// Provider for current page\nfinal vocabularyPageProvider = StateProvider<int>((ref) => 0);\n\n/// Provider for loading vocabulary with pagination\nfinal vocabularyProvider = FutureProvider<Map<String, dynamic>>((ref) async {\n  final supabase = ref.watch(supabaseClientProvider);\n  final search = ref.watch(vocabularySearchProvider);\n  final levelFilter = ref.watch(vocabularyLevelFilterProvider);\n  final page = ref.watch(vocabularyPageProvider);\n\n  const pageSize = 50;\n  final offset = page * pageSize;\n\n  var query = supabase.from('vocabulary_words').select();\n\n  if (search.isNotEmpty) {\n    query = query.ilike('word', '%$search%');\n  }\n  if (levelFilter != null) {\n    query = query.eq('level', levelFilter);\n  }\n\n  final response = await query\n      .order('word')\n      .range(offset, offset + pageSize - 1);\n\n  // Get total count\n  var countQuery = supabase.from('vocabulary_words').select('id');\n  if (search.isNotEmpty) {\n    countQuery = countQuery.ilike('word', '%$search%');\n  }\n  if (levelFilter != null) {\n    countQuery = countQuery.eq('level', levelFilter);\n  }\n  final countResponse = await countQuery;\n  final totalCount = (countResponse as List).length;\n\n  return {\n    'data': List<Map<String, dynamic>>.from(response),\n    'total': totalCount,\n    'page': page,\n    'pageSize': pageSize,\n  };\n});\n\nclass VocabularyListScreen extends ConsumerStatefulWidget {\n  const VocabularyListScreen({super.key});\n\n  @override\n  ConsumerState<VocabularyListScreen> createState() => _VocabularyListScreenState();\n}\n\nclass _VocabularyListScreenState extends ConsumerState<VocabularyListScreen> {\n  final _searchController = TextEditingController();\n\n  @override\n  void dispose() {\n    _searchController.dispose();\n    super.dispose();\n  }\n\n  @override\n  Widget build(BuildContext context) {\n    final vocabAsync = ref.watch(vocabularyProvider);\n    final currentPage = ref.watch(vocabularyPageProvider);\n    final levelFilter = ref.watch(vocabularyLevelFilterProvider);\n\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Vocabulary'),\n        leading: IconButton(\n          icon: const Icon(Icons.arrow_back),\n          onPressed: () => context.go('/'),\n        ),\n        actions: [\n          FilledButton.icon(\n            onPressed: () => context.go('/vocabulary/new'),\n            icon: const Icon(Icons.add, size: 18),\n            label: const Text('New Word'),\n          ),\n          const SizedBox(width: 16),\n        ],\n      ),\n      body: Column(\n        children: [\n          // Search and filters\n          Container(\n            padding: const EdgeInsets.all(16),\n            decoration: BoxDecoration(\n              color: Colors.grey.shade50,\n              border: Border(\n                bottom: BorderSide(color: Colors.grey.shade200),\n              ),\n            ),\n            child: Row(\n              children: [\n                // Search\n                Expanded(\n                  flex: 2,\n                  child: TextField(\n                    controller: _searchController,\n                    decoration: InputDecoration(\n                      hintText: 'Search words...',\n                      prefixIcon: const Icon(Icons.search),\n                      border: const OutlineInputBorder(),\n                      contentPadding: const EdgeInsets.symmetric(horizontal: 12, vertical: 8),\n                      suffixIcon: _searchController.text.isNotEmpty\n                          ? IconButton(\n                              icon: const Icon(Icons.clear),\n                              onPressed: () {\n                                _searchController.clear();\n                                ref.read(vocabularySearchProvider.notifier).state = '';\n                                ref.read(vocabularyPageProvider.notifier).state = 0;\n                              },\n                            )\n                          : null,\n                    ),\n                    onSubmitted: (value) {\n                      ref.read(vocabularySearchProvider.notifier).state = value;\n                      ref.read(vocabularyPageProvider.notifier).state = 0;\n                    },\n                  ),\n                ),\n                const SizedBox(width: 16),\n\n                // Level filter\n                SizedBox(\n                  width: 150,\n                  child: DropdownButtonFormField<String?>(\n                    value: levelFilter,\n                    decoration: const InputDecoration(\n                      labelText: 'Level',\n                      contentPadding: EdgeInsets.symmetric(horizontal: 12, vertical: 8),\n                      border: OutlineInputBorder(),\n                    ),\n                    items: const [\n                      DropdownMenuItem(value: null, child: Text('All Levels')),\n                      DropdownMenuItem(value: 'A1', child: Text('A1')),\n                      DropdownMenuItem(value: 'A2', child: Text('A2')),\n                      DropdownMenuItem(value: 'B1', child: Text('B1')),\n                      DropdownMenuItem(value: 'B2', child: Text('B2')),\n                      DropdownMenuItem(value: 'C1', child: Text('C1')),\n                      DropdownMenuItem(value: 'C2', child: Text('C2')),\n                    ],\n                    onChanged: (value) {\n                      ref.read(vocabularyLevelFilterProvider.notifier).state = value;\n                      ref.read(vocabularyPageProvider.notifier).state = 0;\n                    },\n                  ),\n                ),\n              ],\n            ),\n          ),\n\n          // Vocabulary list\n          Expanded(\n            child: vocabAsync.when(\n              data: (result) {\n                final words = result['data'] as List<Map<String, dynamic>>;\n                final total = result['total'] as int;\n                final pageSize = result['pageSize'] as int;\n                final totalPages = (total / pageSize).ceil();\n\n                if (words.isEmpty) {\n                  return Center(\n                    child: Column(\n                      mainAxisAlignment: MainAxisAlignment.center,\n                      children: [\n                        Icon(\n                          Icons.abc,\n                          size: 64,\n                          color: Colors.grey.shade400,\n                        ),\n                        const SizedBox(height: 16),\n                        Text(\n                          'No words found',\n                          style: TextStyle(\n                            fontSize: 18,\n                            color: Colors.grey.shade600,\n                          ),\n                        ),\n                        const SizedBox(height: 8),\n                        FilledButton.icon(\n                          onPressed: () => context.go('/vocabulary/new'),\n                          icon: const Icon(Icons.add),\n                          label: const Text('Add your first word'),\n                        ),\n                      ],\n                    ),\n                  );\n                }\n\n                return Column(\n                  children: [\n                    // Results info\n                    Container(\n                      padding: const EdgeInsets.symmetric(horizontal: 24, vertical: 8),\n                      child: Row(\n                        mainAxisAlignment: MainAxisAlignment.spaceBetween,\n                        children: [\n                          Text(\n                            'Showing ${words.length} of $total words',\n                            style: TextStyle(color: Colors.grey.shade600),\n                          ),\n                          Text(\n                            'Page ${currentPage + 1} of $totalPages',\n                            style: TextStyle(color: Colors.grey.shade600),\n                          ),\n                        ],\n                      ),\n                    ),\n\n                    // Table\n                    Expanded(\n                      child: SingleChildScrollView(\n                        padding: const EdgeInsets.symmetric(horizontal: 24),\n                        child: Table(\n                          columnWidths: const {\n                            0: FlexColumnWidth(2),\n                            1: FlexColumnWidth(1),\n                            2: FlexColumnWidth(3),\n                            3: FlexColumnWidth(1),\n                            4: FixedColumnWidth(50),\n                          },\n                          border: TableBorder.all(\n                            color: Colors.grey.shade200,\n                            borderRadius: BorderRadius.circular(8),\n                          ),\n                          children: [\n                            // Header\n                            TableRow(\n                              decoration: BoxDecoration(\n                                color: Colors.grey.shade100,\n                                borderRadius: const BorderRadius.vertical(\n                                  top: Radius.circular(8),\n                                ),\n                              ),\n                              children: const [\n                                Padding(\n                                  padding: EdgeInsets.all(12),\n                                  child: Text(\n                                    'Word',\n                                    style: TextStyle(fontWeight: FontWeight.bold),\n                                  ),\n                                ),\n                                Padding(\n                                  padding: EdgeInsets.all(12),\n                                  child: Text(\n                                    'Type',\n                                    style: TextStyle(fontWeight: FontWeight.bold),\n                                  ),\n                                ),\n                                Padding(\n                                  padding: EdgeInsets.all(12),\n                                  child: Text(\n                                    'Meaning (TR)',\n                                    style: TextStyle(fontWeight: FontWeight.bold),\n                                  ),\n                                ),\n                                Padding(\n                                  padding: EdgeInsets.all(12),\n                                  child: Text(\n                                    'Level',\n                                    style: TextStyle(fontWeight: FontWeight.bold),\n                                  ),\n                                ),\n                                SizedBox(),\n                              ],\n                            ),\n                            // Data rows\n                            ...words.map((word) => TableRow(\n                                  children: [\n                                    InkWell(\n                                      onTap: () => context.go('/vocabulary/${word['id']}'),\n                                      child: Padding(\n                                        padding: const EdgeInsets.all(12),\n                                        child: Text(\n                                          word['word'] ?? '',\n                                          style: const TextStyle(\n                                            fontWeight: FontWeight.w500,\n                                            color: Color(0xFF4F46E5),\n                                          ),\n                                        ),\n                                      ),\n                                    ),\n                                    Padding(\n                                      padding: const EdgeInsets.all(12),\n                                      child: Text(\n                                        word['part_of_speech'] ?? '',\n                                        style: TextStyle(\n                                          color: Colors.grey.shade600,\n                                          fontSize: 13,\n                                        ),\n                                      ),\n                                    ),\n                                    Padding(\n                                      padding: const EdgeInsets.all(12),\n                                      child: Text(\n                                        word['meaning_tr'] ?? '',\n                                        maxLines: 2,\n                                        overflow: TextOverflow.ellipsis,\n                                      ),\n                                    ),\n                                    Padding(\n                                      padding: const EdgeInsets.all(12),\n                                      child: _LevelBadge(level: word['level'] ?? 'B1'),\n                                    ),\n                                    InkWell(\n                                      onTap: () => context.go('/vocabulary/${word['id']}'),\n                                      child: const Padding(\n                                        padding: EdgeInsets.all(12),\n                                        child: Icon(\n                                          Icons.chevron_right,\n                                          color: Colors.grey,\n                                        ),\n                                      ),\n                                    ),\n                                  ],\n                                )),\n                          ],\n                        ),\n                      ),\n                    ),\n\n                    // Pagination\n                    Container(\n                      padding: const EdgeInsets.all(16),\n                      child: Row(\n                        mainAxisAlignment: MainAxisAlignment.center,\n                        children: [\n                          IconButton(\n                            onPressed: currentPage > 0\n                                ? () {\n                                    ref.read(vocabularyPageProvider.notifier).state =\n                                        currentPage - 1;\n                                  }\n                                : null,\n                            icon: const Icon(Icons.chevron_left),\n                          ),\n                          const SizedBox(width: 16),\n                          Text('Page ${currentPage + 1} of $totalPages'),\n                          const SizedBox(width: 16),\n                          IconButton(\n                            onPressed: currentPage < totalPages - 1\n                                ? () {\n                                    ref.read(vocabularyPageProvider.notifier).state =\n                                        currentPage + 1;\n                                  }\n                                : null,\n                            icon: const Icon(Icons.chevron_right),\n                          ),\n                        ],\n                      ),\n                    ),\n                  ],\n                );\n              },\n              loading: () => const Center(child: CircularProgressIndicator()),\n              error: (error, _) => Center(\n                child: Column(\n                  mainAxisAlignment: MainAxisAlignment.center,\n                  children: [\n                    Icon(Icons.error_outline, size: 48, color: Colors.red.shade400),\n                    const SizedBox(height: 16),\n                    Text('Error: $error'),\n                    const SizedBox(height: 16),\n                    FilledButton(\n                      onPressed: () => ref.invalidate(vocabularyProvider),\n                      child: const Text('Retry'),\n                    ),\n                  ],\n                ),\n              ),\n            ),\n          ),\n        ],\n      ),\n    );\n  }\n}\n\nclass _LevelBadge extends StatelessWidget {\n  const _LevelBadge({required this.level});\n\n  final String level;\n\n  @override\n  Widget build(BuildContext context) {\n    return Container(\n      padding: const EdgeInsets.symmetric(horizontal: 8, vertical: 4),\n      decoration: BoxDecoration(\n        color: _getColor().withValues(alpha: 0.1),\n        borderRadius: BorderRadius.circular(4),\n      ),\n      child: Text(\n        level,\n        style: TextStyle(\n          fontSize: 12,\n          color: _getColor(),\n          fontWeight: FontWeight.bold,\n        ),\n      ),\n    );\n  }\n\n  Color _getColor() {\n    switch (level) {\n      case 'A1':\n        return Colors.green;\n      case 'A2':\n        return Colors.lightGreen;\n      case 'B1':\n        return Colors.orange;\n      case 'B2':\n        return Colors.deepOrange;\n      case 'C1':\n        return Colors.red;\n      case 'C2':\n        return Colors.purple;\n      default:\n        return Colors.grey;\n    }\n  }\n}\n"
        },
        "caller": {
          "type": "direct"
        }
      }
    ]
  },
  {
    "role": "user",
    "content": [
      {
        "tool_use_id": "toolu_01EYbMYgTej56AkXkQLbgLWX",
        "type": "tool_result",
        "content": "File created successfully at: /Users/wonderelt/Desktop/readeng_admin/lib/features/vocabulary/screens/vocabulary_list_screen.dart"
      }
    ]
  },
  {
    "role": "assistant",
    "content": [
      {
        "type": "tool_use",
        "id": "toolu_01GBR9sPuCW2PipavJSdFoSV",
        "name": "Write",
        "input": {
          "file_path": "/Users/wonderelt/Desktop/readeng_admin/lib/features/vocabulary/screens/vocabulary_edit_screen.dart",
