          "plan": "# Senkronize Sesli Okuma ve Highlight Sistemi\n\n## Özet\nReader ekranlarına paragraf bazlı sesli okuma ve **kelime-seviye metin senkronizasyonu** eklenmesi. Ses çalarken her kelime sırayla highlight edilecek (karaoke tarzı).\n\n## Kullanıcı Kararları\n- **Audio Kaynağı**: ~~Fal AI~~ → **ElevenLabs TTS with-timestamps** (tek API, timestamp dahil)\n- **Highlight Seviyesi**: Kelime seviyesi (karaoke)\n- **Veri Yapısı**: ContentBlock entity oluşturulacak (restructure)\n- **Scope**: Faz 1 + 2 birlikte (MVP + auto-scroll + word highlight)\n- **Admin Panel**: Faz 1'e dahil, ayrı web app olarak\n\n---\n\n## Mevcut Durum Analizi\n\n### Reader Sistemi\n- `ReaderScreen` → Ana container (Riverpod)\n- `IntegratedReaderContent` → Aktivite-gated içerik orchestration\n- `ParagraphWidget` → Vocabulary highlight desteği ile paragraf render\n- Content: Plain text, `\\n\\n` ile paragraf ayrımı\n- Vocabulary: `startIndex/endIndex` karakter pozisyonları ile highlight\n\n### Audio Altyapısı (HAZIR)\n- `AudioService` → `just_audio` ile tam implementasyon\n- `Chapter.audioUrl` → Mevcut ama UI'da kullanılmıyor\n- Cloudflare R2 → Media storage hazır\n\n### Kritik Dosyalar\n```\nlib/presentation/screens/reader/reader_screen.dart          # Ana reader\nlib/presentation/widgets/reader/paragraph_widget.dart       # Paragraf render\nlib/presentation/widgets/reader/integrated_reader_content.dart  # İçerik orchestration\nlib/presentation/providers/reader_provider.dart             # State management\nlib/core/services/audio_service.dart                        # Audio playback\nlib/domain/entities/chapter.dart                            # Chapter entity\n```\n\n---\n\n## Önerilen Mimari\n\n### 1. Data Model: AudioSyncData (Yeni Entity)\n\n```dart\n/// Senkronizasyon granülaritesi\nenum SyncGranularity { paragraph, sentence, word }\n\n/// Chapter için audio timing verisi\nclass AudioSyncData {\n  final String id;\n  final String chapterId;\n  final String audioUrl;\n  final Duration duration;\n  final SyncGranularity granularity;\n  final List<AudioSegment> segments;\n  final String? source; // 'manual', 'tts', 'forced_alignment'\n}\n\n/// Zamanlı metin segmenti\nclass AudioSegment {\n  final String text;\n  final Duration startTime;\n  final Duration endTime;\n  final int startIndex;  // Content içindeki karakter pozisyonu\n  final int endIndex;\n  final int? paragraphIndex;\n  final int? sentenceIndex;\n}\n```\n\n### 2. Database Schema\n\n```sql\nCREATE TABLE audio_sync_data (\n    id UUID PRIMARY KEY,\n    chapter_id UUID REFERENCES chapters(id) ON DELETE CASCADE,\n    audio_url VARCHAR(500) NOT NULL,\n    duration_ms INTEGER NOT NULL,\n    granularity VARCHAR(20) CHECK (granularity IN ('paragraph', 'sentence', 'word')),\n    segments JSONB NOT NULL,  -- [{text, startMs, endMs, startIndex, endIndex, ...}]\n    source VARCHAR(50),\n    created_at TIMESTAMPTZ DEFAULT NOW()\n);\n```\n\n### 3. Timing Data Format (JSON)\n\n```json\n{\n  \"segments\": [\n    {\n      \"text\": \"Once upon a time, there lived a merchant.\",\n      \"startMs\": 0,\n      \"endMs\": 2500,\n      \"startIndex\": 0,\n      \"endIndex\": 42,\n      \"paragraphIndex\": 0,\n      \"sentenceIndex\": 0\n    }\n  ]\n}\n```\n\n### 4. Flutter Widget Mimarisi\n\n```\n┌─────────────────────────────────────────────────────────────┐\n│                      ReaderScreen                           │\n│  ┌──────────────────────────────────────────────────────┐  │\n│  │              AudioPlayerControls (Floating)           │  │\n│  │  [◀◀] [▶/⏸] [▶▶] ━━━━●━━━━━━━ 01:23/05:45  [1.0x]   │  │\n│  └──────────────────────────────────────────────────────┘  │\n│                                                             │\n│  ┌──────────────────────────────────────────────────────┐  │\n│  │           ContentBlockList (yeni widget)              │  │\n│  │  ┌────────────────────────────────────────────────┐  │  │\n│  │  │  TextBlockWidget (type: text)                  │  │  │\n│  │  │  \"Once upon a [TIME] there lived...\"           │  │  │\n│  │  │                   ↑                            │  │  │\n│  │  │           [HIGHLIGHTED WORD]                   │  │  │\n│  │  └────────────────────────────────────────────────┘  │  │\n│  │  ┌────────────────────────────────────────────────┐  │  │\n│  │  │  ImageBlockWidget (type: image)                │  │  │\n│  │  │  [═══════════ IMAGE ═══════════]               │  │  │\n│  │  │  \"A castle on the hill\"                        │  │  │\n│  │  └────────────────────────────────────────────────┘  │  │\n│  │  ┌────────────────────────────────────────────────┐  │  │\n│  │  │  ActivityBlockWidget (type: activity)          │  │  │\n│  │  │  [True/False Question]                         │  │  │\n│  │  └────────────────────────────────────────────────┘  │  │\n│  └──────────────────────────────────────────────────────┘  │\n└─────────────────────────────────────────────────────────────┘\n```\n\n### Word-Level Highlight Widget\n\n```dart\nclass WordHighlightText extends StatelessWidget {\n  final String text;\n  final List<WordTiming> wordTimings;\n  final int? activeWordIndex;  // Provider'dan gelir\n  final ReaderSettings settings;\n\n  @override\n  Widget build(BuildContext context) {\n    return RichText(\n      text: TextSpan(\n        children: _buildWordSpans(),\n      ),\n    );\n  }\n\n  List<InlineSpan> _buildWordSpans() {\n    final spans = <InlineSpan>[];\n    int currentIndex = 0;\n\n    for (int i = 0; i < wordTimings.length; i++) {\n      final timing = wordTimings[i];\n\n      // Kelime öncesi boşluk/punctuation\n      if (timing.startIndex > currentIndex) {\n        spans.add(TextSpan(\n          text: text.substring(currentIndex, timing.startIndex),\n          style: _normalStyle,\n        ));\n      }\n\n      // Kelime (highlight edilmiş veya normal)\n      final isActive = i == activeWordIndex;\n      spans.add(TextSpan(\n        text: timing.word,\n        style: isActive ? _highlightStyle : _normalStyle,\n      ));\n\n      currentIndex = timing.endIndex;\n    }\n\n    // Kalan metin\n    if (currentIndex < text.length) {\n      spans.add(TextSpan(text: text.substring(currentIndex)));\n    }\n\n    return spans;\n  }\n\n  TextStyle get _highlightStyle => TextStyle(\n    backgroundColor: Colors.yellow.withOpacity(0.5),\n    fontWeight: FontWeight.bold,\n  );\n}\n```\n\n### 5. Audio Sync Provider\n\n```dart\nclass AudioSyncController extends StateNotifier<AudioSyncState> {\n  // Audio position stream dinle\n  // Binary search ile aktif segment bul\n  // State güncelle → UI highlight değişir\n\n  void _onPositionChanged(Duration position) {\n    final activeIndex = _findActiveSegment(segments, position);\n    state = state.copyWith(activeSegmentIndex: activeIndex);\n  }\n}\n```\n\n---\n\n## ContentBlock Mimarisi (SEÇİLDİ)\n\nMevcut `Chapter.content` (plain text) yapısından **explicit ContentBlock** yapısına geçiş.\n\n### Yeni Entity: ContentBlock\n\n```dart\nenum ContentBlockType {\n  text,      // Paragraf metni\n  image,     // Görsel\n  audio,     // Standalone ses (podcast tarzı)\n  activity,  // Inline aktivite referansı\n}\n\nclass ContentBlock {\n  final String id;\n  final String chapterId;\n  final int orderIndex;\n  final ContentBlockType type;\n\n  // Text block için\n  final String? text;\n  final List<WordTiming>? wordTimings;  // Kelime-seviye sync\n  final String? audioUrl;               // Bu blok için ses\n\n  // Image block için\n  final String? imageUrl;\n  final String? caption;\n\n  // Activity block için\n  final String? activityId;\n}\n\nclass WordTiming {\n  final String word;\n  final int startIndex;      // Metin içi karakter pozisyonu\n  final int endIndex;\n  final int startMs;         // Audio başlangıç (milisaniye)\n  final int endMs;           // Audio bitiş\n}\n```\n\n### Database Schema: content_blocks\n\n```sql\nCREATE TABLE content_blocks (\n    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    chapter_id UUID NOT NULL REFERENCES chapters(id) ON DELETE CASCADE,\n    order_index INTEGER NOT NULL,\n    type VARCHAR(20) NOT NULL CHECK (type IN ('text', 'image', 'audio', 'activity')),\n\n    -- Text block\n    text TEXT,\n    audio_url VARCHAR(500),\n    word_timings JSONB,  -- [{word, startIndex, endIndex, startMs, endMs}]\n\n    -- Image block\n    image_url VARCHAR(500),\n    caption TEXT,\n\n    -- Activity block\n    activity_id UUID REFERENCES inline_activities(id),\n\n    created_at TIMESTAMPTZ DEFAULT NOW(),\n    updated_at TIMESTAMPTZ DEFAULT NOW(),\n\n    UNIQUE(chapter_id, order_index)\n);\n\nCREATE INDEX idx_content_blocks_chapter ON content_blocks(chapter_id);\n```\n\n### Migration Stratejisi\n\n```\nMevcut: chapters.content (plain text \"\\n\\n\" separated)\n        ↓\nYeni:   content_blocks tablosu (her paragraf ayrı row)\n```\n\n1. Mevcut chapter'ları parse et\n2. Her paragraf için `content_blocks` row oluştur\n3. `chapters.content` → deprecated (nullable yap)\n4. Yeni content ekleme artık `content_blocks` üzerinden\n\n---\n\n## Audio Pipeline: ElevenLabs TTS with Timestamps (BASİTLEŞTİ!)\n\n### ElevenLabs Avantajları\n- **Endpoint**: `POST /v1/text-to-speech/:voice_id/with-timestamps`\n- **TEK API ÇAĞRISI** = Audio + Word Timings (ayrı alignment yok!)\n- **150+ dil** (Türkçe dahil)\n- **Karakter ve kelime seviyesi** timestamp\n- **Karaoke, subtitle, lip-sync** için ideal\n\n### Basitleştirilmiş Pipeline\n\n```\n┌─────────────┐     ┌─────────────────────┐     ┌─────────────────┐\n│ ContentBlock│────▶│  ElevenLabs TTS     │────▶│  Audio File +   │\n│   (text)    │     │  with-timestamps    │     │  Word Timings   │\n└─────────────┘     └─────────────────────┘     └─────────────────┘\n                            │\n                            ▼\n                    ┌─────────────────┐\n                    │  R2 Upload +    │\n                    │  DB Update      │\n                    └─────────────────┘\n```\n\n**Forced alignment'a gerek yok** - ElevenLabs direkt veriyor!\n\n### ElevenLabs Response Format\n\n```json\n{\n  \"audio_base64\": \"...\",\n  \"alignment\": {\n    \"characters\": [\"H\",\"e\",\"l\",\"l\",\"o\",\" \",\"w\",\"o\",\"r\",\"l\",\"d\"],\n    \"character_start_times_seconds\": [0.0, 0.05, 0.1, ...],\n    \"character_end_times_seconds\": [0.05, 0.1, 0.15, ...]\n  }\n}\n```\n\n### Edge Function: generate-audio-sync (Basitleşti)\n\n```typescript\n// supabase/functions/generate-audio-sync/index.ts\nDeno.serve(async (req) => {\n  const { blockId, text, voiceId } = await req.json();\n\n  // 1. ElevenLabs TTS with timestamps - TEK ÇAĞRI!\n  const response = await fetch(\n    `https://api.elevenlabs.io/v1/text-to-speech/${voiceId}/with-timestamps`,\n    {\n      method: 'POST',\n      headers: {\n        'xi-api-key': Deno.env.get('ELEVENLABS_API_KEY'),\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        text,\n        model_id: 'eleven_multilingual_v2',\n        output_format: 'mp3_44100_128',\n      }),\n    }\n  );\n\n  const { audio_base64, alignment } = await response.json();\n\n  // 2. Audio'yu R2'ye yükle\n  const audioBuffer = Buffer.from(audio_base64, 'base64');\n  const audioUrl = await uploadToR2(audioBuffer, `${blockId}.mp3`);\n\n  // 3. Character timestamps → Word timings dönüştür\n  const wordTimings = convertToWordTimings(text, alignment);\n\n  // 4. Database güncelle\n  await supabase.from('content_blocks').update({\n    audio_url: audioUrl,\n    word_timings: wordTimings,\n  }).eq('id', blockId);\n\n  return Response.json({ success: true, audioUrl, wordTimings });\n});\n\n// Helper: Karakter timestamp'lerini kelime timestamp'lerine dönüştür\nfunction convertToWordTimings(text: string, alignment: any) {\n  const words = text.split(/\\s+/);\n  const timings = [];\n  let charIndex = 0;\n\n  for (const word of words) {\n    const startMs = Math.floor(alignment.character_start_times_seconds[charIndex] * 1000);\n    const endCharIndex = charIndex + word.length - 1;\n    const endMs = Math.floor(alignment.character_end_times_seconds[endCharIndex] * 1000);\n\n    timings.push({\n      word,\n      startIndex: text.indexOf(word, charIndex),\n      endIndex: text.indexOf(word, charIndex) + word.length,\n      startMs,\n      endMs,\n    });\n\n    charIndex = endCharIndex + 2; // +1 word, +1 space\n  }\n\n  return timings;\n}\n```\n\n---\n\n## Uygulama Planı (Yeniden Yapılandırılmış)\n\n### FAZ 1A: Database & Backend Altyapısı\n\n**Adım 1.1: Database Schema**\n- [ ] `content_blocks` tablosu oluştur\n- [ ] Mevcut `chapters.content` → `content_blocks` migration scripti\n- [ ] `chapters.content` nullable yap (backward compat)\n\n```\nsupabase/migrations/YYYYMMDD_content_blocks.sql\nsupabase/migrations/YYYYMMDD_migrate_content_to_blocks.sql\n```\n\n**Adım 1.2: Edge Function - Audio Generation**\n- [ ] ElevenLabs TTS with-timestamps entegrasyonu\n- [ ] R2 upload helper\n- [ ] Character → Word timing dönüşümü\n- [ ] `generate-audio-sync` Edge Function\n\n```\nsupabase/functions/generate-audio-sync/index.ts\nsupabase/functions/_shared/elevenlabs.ts\nsupabase/functions/_shared/r2-upload.ts\n```\n\n---\n\n### FAZ 1B: Admin Web App (Ayrı Proje)\n\n**Yeni Flutter Web projesi**: `readeng-admin/`\n\n**Adım 1.3: Admin Proje Kurulumu**\n- [ ] Flutter web projesi oluştur\n- [ ] Supabase client konfigürasyonu\n- [ ] Auth (admin-only login)\n- [ ] Temel routing\n\n**Adım 1.4: Kitap Yönetimi**\n- [ ] Kitap listesi ekranı\n- [ ] Kitap oluştur/düzenle formu\n- [ ] Chapter listesi ve sıralama\n- [ ] Chapter içerik editörü (rich text veya markdown)\n\n**Adım 1.5: ContentBlock Editörü**\n- [ ] Block listesi (drag & drop sıralama)\n- [ ] Text block editörü\n- [ ] Image block upload\n- [ ] Activity block oluşturma\n\n**Adım 1.6: Audio Generation UI**\n- [ ] Voice seçimi (ElevenLabs voices)\n- [ ] \"Generate Audio\" butonu per block\n- [ ] Preview player\n- [ ] Bulk generate (tüm chapter için)\n- [ ] Progress indicator\n\n```\nreadeng-admin/\n├── lib/\n│   ├── main.dart\n│   ├── core/\n│   │   ├── supabase_client.dart\n│   │   └── elevenlabs_service.dart\n│   ├── features/\n│   │   ├── auth/\n│   │   ├── books/\n│   │   │   ├── screens/\n│   │   │   │   ├── book_list_screen.dart\n│   │   │   │   ├── book_edit_screen.dart\n│   │   │   │   └── chapter_edit_screen.dart\n│   │   │   └── widgets/\n│   │   │       ├── content_block_editor.dart\n│   │   │       └── audio_generator_widget.dart\n│   │   └── dashboard/\n│   └── shared/\n└── pubspec.yaml\n```\n\n---\n\n### FAZ 2: Reader App Widget'ları (Ana App)\n\n**Adım 2.1: Domain Layer**\n- [ ] `ContentBlock` entity\n- [ ] `WordTiming` value object\n- [ ] `ContentBlockRepository` interface\n- [ ] `GetContentBlocksUseCase`\n\n```\nlib/domain/entities/content_block.dart\nlib/domain/entities/word_timing.dart\nlib/domain/repositories/content_block_repository.dart\nlib/domain/usecases/content/get_content_blocks_usecase.dart\n```\n\n**Adım 2.2: Data Layer**\n- [ ] `ContentBlockModel` (JSON serialization)\n- [ ] `WordTimingModel`\n- [ ] `SupabaseContentBlockRepository`\n\n```\nlib/data/models/content/content_block_model.dart\nlib/data/models/content/word_timing_model.dart\nlib/data/repositories/supabase/supabase_content_block_repository.dart\n```\n\n**Adım 2.3: Providers**\n- [ ] `contentBlocksProvider`\n- [ ] `audioSyncProvider` (playback state + aktif kelime)\n- [ ] `AudioSyncController`\n\n```\nlib/presentation/providers/content_block_provider.dart\nlib/presentation/providers/audio_sync_provider.dart\n```\n\n**Adım 2.4: Widgets**\n- [ ] `ContentBlockList`\n- [ ] `TextBlockWidget` + `WordHighlightText`\n- [ ] `ImageBlockWidget`\n- [ ] `ActivityBlockWidget`\n- [ ] `AudioPlayerControls`\n\n```\nlib/presentation/widgets/reader/content_block_list.dart\nlib/presentation/widgets/reader/text_block_widget.dart\nlib/presentation/widgets/reader/word_highlight_text.dart\nlib/presentation/widgets/reader/image_block_widget.dart\nlib/presentation/widgets/reader/activity_block_widget.dart\nlib/presentation/widgets/reader/audio_player_controls.dart\n```\n\n**Adım 2.5: ReaderScreen Entegrasyonu**\n- [ ] `IntegratedReaderContent` → `ContentBlockList` geçişi\n- [ ] `AudioPlayerControls` floating widget\n- [ ] Auto-scroll (aktif kelimeyi takip)\n\n```\nlib/presentation/screens/reader/reader_screen.dart (modify)\n```\n\n---\n\n## Dosya Özeti\n\n### Ana App (wonderlib/) - 14 dosya\n\n| Katman | Dosya |\n|--------|-------|\n| Domain | `lib/domain/entities/content_block.dart` |\n| Domain | `lib/domain/entities/word_timing.dart` |\n| Domain | `lib/domain/repositories/content_block_repository.dart` |\n| Domain | `lib/domain/usecases/content/get_content_blocks_usecase.dart` |\n| Data | `lib/data/models/content/content_block_model.dart` |\n| Data | `lib/data/models/content/word_timing_model.dart` |\n| Data | `lib/data/repositories/supabase/supabase_content_block_repository.dart` |\n| Provider | `lib/presentation/providers/content_block_provider.dart` |\n| Provider | `lib/presentation/providers/audio_sync_provider.dart` |\n| Widget | `lib/presentation/widgets/reader/content_block_list.dart` |\n| Widget | `lib/presentation/widgets/reader/text_block_widget.dart` |\n| Widget | `lib/presentation/widgets/reader/word_highlight_text.dart` |\n| Widget | `lib/presentation/widgets/reader/image_block_widget.dart` |\n| Widget | `lib/presentation/widgets/reader/audio_player_controls.dart` |\n\n### Supabase - 4 dosya\n\n| Tip | Dosya |\n|-----|-------|\n| Migration | `supabase/migrations/YYYYMMDD_content_blocks.sql` |\n| Migration | `supabase/migrations/YYYYMMDD_migrate_content.sql` |\n| Edge Fn | `supabase/functions/generate-audio-sync/index.ts` |\n| Shared | `supabase/functions/_shared/elevenlabs.ts` |\n\n### Admin App (readeng-admin/) - Yeni Proje (~15 dosya)\n\n| Dosya | Açıklama |\n|-------|----------|\n| `lib/main.dart` | Entry point |\n| `lib/core/supabase_client.dart` | Supabase config |\n| `lib/core/elevenlabs_service.dart` | ElevenLabs API client |\n| `lib/features/auth/` | Admin login |\n| `lib/features/books/screens/book_list_screen.dart` | Kitap listesi |\n| `lib/features/books/screens/book_edit_screen.dart` | Kitap düzenleme |\n| `lib/features/books/screens/chapter_edit_screen.dart` | Chapter düzenleme |\n| `lib/features/books/widgets/content_block_editor.dart` | Block editörü |\n| `lib/features/books/widgets/audio_generator_widget.dart` | TTS UI |\n| `pubspec.yaml` | Dependencies |\n\n### Değiştirilecek Dosyalar (Ana App) - 4 dosya\n\n| Dosya | Değişiklik |\n|-------|------------|\n| `lib/presentation/screens/reader/reader_screen.dart` | ContentBlockList + AudioPlayerControls |\n| `lib/presentation/providers/repository_providers.dart` | ContentBlockRepository provider ekle |\n| `lib/presentation/providers/usecase_providers.dart` | UseCase provider'lar ekle |\n| `lib/domain/entities/chapter.dart` | `content` → deprecated, `hasContentBlocks` getter |\n\n---\n\n## Verification Plan\n\n### Faz 1A: Backend Verification\n\n```bash\n# 1. Migration test\nsupabase db reset\n# content_blocks tablosu oluşmalı\n\n# 2. Edge function deploy\nsupabase functions deploy generate-audio-sync\n\n# 3. Edge function test\ncurl -X POST \"https://xxx.supabase.co/functions/v1/generate-audio-sync\" \\\n  -H \"Authorization: Bearer xxx\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"blockId\": \"test-uuid\", \"text\": \"Hello world\", \"voiceId\": \"21m00Tcm4TlvDq8ikWAM\"}'\n# Response: { audioUrl, wordTimings }\n```\n\n### Faz 1B: Admin App Verification\n\n| Senaryo | Beklenen |\n|---------|----------|\n| Admin login | Supabase auth çalışır |\n| Kitap listesi | Mevcut kitaplar görünür |\n| Yeni kitap oluştur | DB'ye kayıt |\n| Chapter ekle | Sıralama çalışır |\n| ContentBlock ekle | Text/image/activity block |\n| Generate Audio | ElevenLabs çağrılır, audio R2'ye yüklenir |\n| Preview | Audio + highlight preview |\n\n### Faz 2: Reader App Verification\n\n```bash\n# 1. Statik analiz\ndart analyze lib/\n# Hata: 0\n\n# 2. Unit tests\nflutter test test/unit/domain/entities/content_block_test.dart\nflutter test test/unit/data/models/content_block_model_test.dart\n```\n\n| Senaryo | Beklenen |\n|---------|----------|\n| Chapter aç (audio var) | AudioPlayerControls görünür |\n| Play'e bas | Audio çalar, kelimeler sırayla highlight |\n| Pause | Audio durur, highlight son kelimede kalır |\n| Speed 1.5x | Hızlı çalar, highlight senkron kalır |\n| Kelimeye tıkla | O noktaya seek eder |\n| Auto-scroll | Aktif kelime viewport'ta kalır |\n| Chapter aç (audio yok) | AudioPlayerControls gizli |\n\n---\n\n## Açık Kararlar (Sonradan)\n\n1. **ElevenLabs Voice Seçimi**: Hangi voice'lar kullanılacak? (Test edilmeli)\n2. **Türkçe TTS Kalitesi**: ElevenLabs Türkçe'yi ne kadar iyi destekliyor?\n3. **Offline Cache**: Audio dosyaları local'e cache edilecek mi?\n4. **Admin Auth**: Sadece belirli email'ler mi, role-based mi?\n5. **Bulk Generation**: Tüm kitap için batch TTS nasıl handle edilecek?\n6. **Cost Tracking**: ElevenLabs API maliyeti nasıl takip edilecek?\n"
        },
        "caller": {
          "type": "direct"
        }
      }
    ]
  },
  {
    "role": "user",
    "content": [
      {
        "type": "tool_result",
